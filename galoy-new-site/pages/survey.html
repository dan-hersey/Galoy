<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Digital Asset Readiness Survey | Galoy</title>
  <link rel="icon" type="image/png" href="../images/favicon.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet">
  <style>
    /* Design Tokens */
    :root {
      --galoy-blue: #3654ff;
      --galoy-blue-hover: #2a45d9;
      --bitcoin-orange: #f68e1d;
      --galoy-grey: #17181c;
      --font-grey: #6f717d;
      --light-grey: #f5f7fa;
      --white: #ffffff;
      --border-grey: #e5e7eb;
      --font-family: 'IBM Plex Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      --radius-md: 8px;
      --radius-lg: 12px;
      --radius-full: 9999px;
      --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.1);
      --transition-base: 250ms ease;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: var(--font-family);
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      color: var(--galoy-grey);
    }

    /* Survey Container */
    .survey-container {
      width: 100%;
      max-width: 600px;
      background: var(--white);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-lg);
      overflow: hidden;
    }

    /* Header */
    .survey-header {
      background: linear-gradient(135deg, var(--galoy-blue) 0%, #1e3a8a 100%);
      padding: 2rem;
      text-align: center;
      color: var(--white);
    }

    .survey-header img {
      height: 32px;
      margin: 0 auto 1.5rem;
    }

    .survey-header h1 {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .survey-header p {
      font-size: 0.9rem;
      opacity: 0.9;
    }

    /* Progress Bar */
    .progress-container {
      padding: 1.5rem 2rem 0;
    }

    .progress-bar {
      height: 6px;
      background: var(--border-grey);
      border-radius: var(--radius-full);
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--galoy-blue), var(--bitcoin-orange));
      border-radius: var(--radius-full);
      transition: width 0.4s ease;
      width: 0%;
    }

    .progress-text {
      display: flex;
      justify-content: space-between;
      margin-top: 0.5rem;
      font-size: 0.75rem;
      color: var(--font-grey);
    }

    /* Survey Content */
    .survey-content {
      padding: 2rem;
    }

    /* Steps */
    .survey-step {
      display: none;
      animation: fadeIn 0.3s ease;
    }

    .survey-step.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }

    .step-question {
      font-size: 1.125rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--galoy-grey);
    }

    .step-hint {
      font-size: 0.875rem;
      color: var(--font-grey);
      margin-bottom: 1.5rem;
    }

    /* Option Cards */
    .option-card {
      display: flex;
      align-items: center;
      padding: 1rem 1.25rem;
      border: 2px solid var(--border-grey);
      border-radius: var(--radius-md);
      margin-bottom: 0.75rem;
      cursor: pointer;
      transition: all var(--transition-base);
    }

    .option-card:hover {
      border-color: var(--galoy-blue);
      background: rgba(54, 84, 255, 0.03);
    }

    .option-card.selected {
      border-color: var(--galoy-blue);
      background: rgba(54, 84, 255, 0.08);
    }

    .option-card input {
      display: none;
    }

    .option-checkbox {
      width: 20px;
      height: 20px;
      border: 2px solid var(--border-grey);
      border-radius: 4px;
      margin-right: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      transition: all var(--transition-base);
    }

    .option-card.selected .option-checkbox {
      border-color: var(--galoy-blue);
      background: var(--galoy-blue);
    }

    .option-checkbox .material-symbols-outlined {
      font-size: 16px;
      color: var(--white);
      opacity: 0;
      transition: opacity var(--transition-base);
    }

    .option-card.selected .option-checkbox .material-symbols-outlined {
      opacity: 1;
    }

    .option-radio {
      width: 20px;
      height: 20px;
      border: 2px solid var(--border-grey);
      border-radius: 50%;
      margin-right: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      transition: all var(--transition-base);
    }

    .option-card.selected .option-radio {
      border-color: var(--galoy-blue);
    }

    .option-radio::after {
      content: '';
      width: 10px;
      height: 10px;
      background: var(--galoy-blue);
      border-radius: 50%;
      opacity: 0;
      transition: opacity var(--transition-base);
    }

    .option-card.selected .option-radio::after {
      opacity: 1;
    }

    .option-text {
      font-size: 0.95rem;
      color: var(--galoy-grey);
    }

    /* Ranking Options */
    .ranking-options {
      counter-reset: ranking;
    }

    .ranking-option {
      display: flex;
      align-items: center;
      padding: 1rem 1.25rem;
      border: 2px solid var(--border-grey);
      border-radius: var(--radius-md);
      margin-bottom: 0.75rem;
      cursor: grab;
      transition: all var(--transition-base);
      background: var(--white);
    }

    .ranking-option:hover {
      border-color: var(--galoy-blue);
    }

    .ranking-option.dragging {
      opacity: 0.5;
      cursor: grabbing;
    }

    .ranking-number {
      width: 28px;
      height: 28px;
      background: var(--galoy-blue);
      color: var(--white);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.875rem;
      margin-right: 1rem;
      flex-shrink: 0;
    }

    .ranking-handle {
      margin-left: auto;
      color: var(--font-grey);
    }

    /* Mobile ranking buttons */
    .ranking-buttons {
      display: none;
      margin-left: auto;
      gap: 0.25rem;
    }

    .ranking-btn {
      width: 32px;
      height: 32px;
      border: 1px solid var(--border-grey);
      border-radius: 6px;
      background: var(--white);
      color: var(--galoy-grey);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--transition-base);
    }

    .ranking-btn:hover {
      background: var(--galoy-blue);
      border-color: var(--galoy-blue);
      color: var(--white);
    }

    .ranking-btn:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }

    .ranking-btn:disabled:hover {
      background: var(--white);
      border-color: var(--border-grey);
      color: var(--galoy-grey);
    }

    .ranking-btn .material-symbols-outlined {
      font-size: 18px;
    }

    /* Show buttons on mobile, hide drag handle */
    @media (max-width: 768px) {
      .ranking-handle {
        display: none;
      }

      .ranking-buttons {
        display: flex;
      }

      .ranking-option {
        cursor: default;
      }
    }

    /* Form Inputs */
    .form-group {
      margin-bottom: 1.25rem;
    }

    .form-label {
      display: block;
      font-size: 0.875rem;
      font-weight: 500;
      margin-bottom: 0.5rem;
      color: var(--galoy-grey);
    }

    .form-input {
      width: 100%;
      padding: 0.875rem 1rem;
      border: 2px solid var(--border-grey);
      border-radius: var(--radius-md);
      font-family: var(--font-family);
      font-size: 1rem;
      color: var(--galoy-grey);
      transition: border-color var(--transition-base);
    }

    .form-input:focus {
      outline: none;
      border-color: var(--galoy-blue);
    }

    .form-input::placeholder {
      color: var(--font-grey);
    }

    /* Navigation */
    .survey-nav {
      display: flex;
      justify-content: space-between;
      padding: 1.5rem 2rem 2rem;
      border-top: 1px solid var(--border-grey);
    }

    .btn {
      padding: 0.875rem 1.75rem;
      border-radius: var(--radius-md);
      font-family: var(--font-family);
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: all var(--transition-base);
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn-secondary {
      background: var(--white);
      border: 2px solid var(--border-grey);
      color: var(--galoy-grey);
    }

    .btn-secondary:hover {
      border-color: var(--galoy-grey);
    }

    .btn-primary {
      background: var(--galoy-blue);
      border: 2px solid var(--galoy-blue);
      color: var(--white);
    }

    .btn-primary:hover {
      background: var(--galoy-blue-hover);
      border-color: var(--galoy-blue-hover);
    }

    .btn-primary:disabled {
      background: var(--border-grey);
      border-color: var(--border-grey);
      cursor: not-allowed;
    }

    .btn .material-symbols-outlined {
      font-size: 18px;
    }

    /* Thank You Screen */
    .thank-you-screen {
      display: none;
      text-align: center;
      padding: 3rem 2rem;
    }

    .thank-you-screen.active {
      display: block;
    }

    .thank-you-icon {
      width: 80px;
      height: 80px;
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 1.5rem;
    }

    .thank-you-icon .material-symbols-outlined {
      font-size: 40px;
      color: var(--white);
    }

    .thank-you-screen h2 {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 0.75rem;
      color: var(--galoy-grey);
    }

    .thank-you-screen p {
      color: var(--font-grey);
      margin-bottom: 2rem;
      line-height: 1.6;
    }

    .thank-you-screen .btn {
      margin: 0 auto;
    }

    /* Responsive */
    @media (max-width: 640px) {
      body {
        padding: 1rem;
      }

      .survey-header {
        padding: 1.5rem;
      }

      .survey-header h1 {
        font-size: 1.25rem;
      }

      .survey-content,
      .survey-nav {
        padding: 1.5rem;
      }

      .progress-container {
        padding: 1rem 1.5rem 0;
      }
    }
  </style>
</head>
<body>

  <div class="survey-container">
    <!-- Header -->
    <div class="survey-header">
      <img src="../images/galoy-logo-white.svg" alt="Galoy">
      <h1>Digital Asset Readiness Pulse</h1>
      <p>See how your digital asset strategy compares to peers in banking</p>
    </div>

    <!-- Progress -->
    <div class="progress-container" id="progressContainer">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text">
        <span id="stepIndicator">Question 1 of 5</span>
        <span id="percentComplete">0% complete</span>
      </div>
    </div>

    <!-- Survey Content -->
    <div class="survey-content">

      <!-- Step 1: Current Posture -->
      <div class="survey-step active" data-step="1">
        <h2 class="step-question">Which best describes your bank's current posture on digital assets?</h2>
        <p class="step-hint">Select one</p>

        <div class="options-list" data-type="radio" data-name="posture">
          <label class="option-card">
            <input type="radio" name="posture" value="actively_exploring">
            <span class="option-radio"></span>
            <span class="option-text">Actively exploring or building products</span>
          </label>
          <label class="option-card">
            <input type="radio" name="posture" value="monitoring">
            <span class="option-radio"></span>
            <span class="option-text">Monitoring / researching, but no active initiatives</span>
          </label>
          <label class="option-card">
            <input type="radio" name="posture" value="not_priority">
            <span class="option-radio"></span>
            <span class="option-text">Not a priority right now</span>
          </label>
        </div>
      </div>

      <!-- Step 2: Ranking -->
      <div class="survey-step" data-step="2">
        <h2 class="step-question">Rank the following digital asset categories in order of relevance for your banking customers.</h2>
        <p class="step-hint">Reorder to rank (1 = Most relevant, 4 = Least relevant)</p>

        <div class="ranking-options" id="rankingList">
          <div class="ranking-option" draggable="true" data-value="bitcoin">
            <span class="ranking-number">1</span>
            <span class="option-text">Bitcoin</span>
            <span class="material-symbols-outlined ranking-handle">drag_indicator</span>
            <div class="ranking-buttons">
              <button type="button" class="ranking-btn ranking-up" aria-label="Move up"><span class="material-symbols-outlined">keyboard_arrow_up</span></button>
              <button type="button" class="ranking-btn ranking-down" aria-label="Move down"><span class="material-symbols-outlined">keyboard_arrow_down</span></button>
            </div>
          </div>
          <div class="ranking-option" draggable="true" data-value="stablecoins">
            <span class="ranking-number">2</span>
            <span class="option-text">Stablecoins / Tokenized Deposits</span>
            <span class="material-symbols-outlined ranking-handle">drag_indicator</span>
            <div class="ranking-buttons">
              <button type="button" class="ranking-btn ranking-up" aria-label="Move up"><span class="material-symbols-outlined">keyboard_arrow_up</span></button>
              <button type="button" class="ranking-btn ranking-down" aria-label="Move down"><span class="material-symbols-outlined">keyboard_arrow_down</span></button>
            </div>
          </div>
          <div class="ranking-option" draggable="true" data-value="other_crypto">
            <span class="ranking-number">3</span>
            <span class="option-text">Other cryptocurrencies (e.g., ETH, SOL)</span>
            <span class="material-symbols-outlined ranking-handle">drag_indicator</span>
            <div class="ranking-buttons">
              <button type="button" class="ranking-btn ranking-up" aria-label="Move up"><span class="material-symbols-outlined">keyboard_arrow_up</span></button>
              <button type="button" class="ranking-btn ranking-down" aria-label="Move down"><span class="material-symbols-outlined">keyboard_arrow_down</span></button>
            </div>
          </div>
          <div class="ranking-option" draggable="true" data-value="none_relevant">
            <span class="ranking-number">4</span>
            <span class="option-text">None are currently relevant</span>
            <span class="material-symbols-outlined ranking-handle">drag_indicator</span>
            <div class="ranking-buttons">
              <button type="button" class="ranking-btn ranking-up" aria-label="Move up"><span class="material-symbols-outlined">keyboard_arrow_up</span></button>
              <button type="button" class="ranking-btn ranking-down" aria-label="Move down"><span class="material-symbols-outlined">keyboard_arrow_down</span></button>
            </div>
          </div>
        </div>
      </div>

      <!-- Step 3: Capabilities -->
      <div class="survey-step" data-step="3">
        <h2 class="step-question">If regulatory clarity and implementation risk were sufficiently addressed, which capabilities would your bank be most interested in exploring?</h2>
        <p class="step-hint">Select up to two</p>

        <div class="options-list" data-type="checkbox" data-name="capabilities" data-max="2">
          <label class="option-card">
            <input type="checkbox" name="capabilities" value="custody">
            <span class="option-checkbox"><span class="material-symbols-outlined">check</span></span>
            <span class="option-text">Digital asset custody</span>
          </label>
          <label class="option-card">
            <input type="checkbox" name="capabilities" value="buy_sell">
            <span class="option-checkbox"><span class="material-symbols-outlined">check</span></span>
            <span class="option-text">Customer buy / sell access</span>
          </label>
          <label class="option-card">
            <input type="checkbox" name="capabilities" value="lending">
            <span class="option-checkbox"><span class="material-symbols-outlined">check</span></span>
            <span class="option-text">Asset-backed lending</span>
          </label>
          <label class="option-card">
            <input type="checkbox" name="capabilities" value="payments">
            <span class="option-checkbox"><span class="material-symbols-outlined">check</span></span>
            <span class="option-text">Payments or settlement use cases</span>
          </label>
          <label class="option-card">
            <input type="checkbox" name="capabilities" value="none">
            <span class="option-checkbox"><span class="material-symbols-outlined">check</span></span>
            <span class="option-text">None of the above</span>
          </label>
        </div>
      </div>

      <!-- Step 4: Leadership -->
      <div class="survey-step" data-step="4">
        <h2 class="step-question">Who leads digital asset strategy at your bank?</h2>
        <p class="step-hint">Select one</p>

        <div class="options-list" data-type="radio" data-name="leadership">
          <label class="option-card">
            <input type="radio" name="leadership" value="executive">
            <span class="option-radio"></span>
            <span class="option-text">Executive leadership (CEO, CIO, COO)</span>
          </label>
          <label class="option-card">
            <input type="radio" name="leadership" value="strategy">
            <span class="option-radio"></span>
            <span class="option-text">Strategy / innovation</span>
          </label>
          <label class="option-card">
            <input type="radio" name="leadership" value="risk">
            <span class="option-radio"></span>
            <span class="option-text">Risk / compliance</span>
          </label>
          <label class="option-card">
            <input type="radio" name="leadership" value="technology">
            <span class="option-radio"></span>
            <span class="option-text">Technology / core banking</span>
          </label>
          <label class="option-card">
            <input type="radio" name="leadership" value="not_defined">
            <span class="option-radio"></span>
            <span class="option-text">Not formally defined yet</span>
          </label>
        </div>
      </div>

      <!-- Step 5: Contact Info -->
      <div class="survey-step" data-step="5">
        <h2 class="step-question">Almost done! Please share your contact information.</h2>
        <p class="step-hint">We'll use this to share relevant insights with you.</p>

        <div class="form-group">
          <label class="form-label" for="firstName">First Name *</label>
          <input type="text" id="firstName" class="form-input" placeholder="Enter your first name" required>
        </div>

        <div class="form-group">
          <label class="form-label" for="lastName">Last Name *</label>
          <input type="text" id="lastName" class="form-input" placeholder="Enter your last name" required>
        </div>

        <div class="form-group">
          <label class="form-label" for="email">Email Address *</label>
          <input type="email" id="email" class="form-input" placeholder="you@company.com" required>
        </div>
      </div>

    </div>

    <!-- Navigation -->
    <div class="survey-nav" id="surveyNav">
      <button class="btn btn-secondary" id="prevBtn" style="visibility: hidden;">
        <span class="material-symbols-outlined">arrow_back</span>
        Back
      </button>
      <button class="btn btn-primary" id="nextBtn">
        Next
        <span class="material-symbols-outlined">arrow_forward</span>
      </button>
    </div>

    <!-- Thank You Screen -->
    <div class="thank-you-screen" id="thankYouScreen">
      <div class="thank-you-icon">
        <span class="material-symbols-outlined">check</span>
      </div>
      <h2>Thank You!</h2>
      <p>Your responses have been recorded. We appreciate you taking the time to share your insights on digital asset readiness.</p>
      <p style="font-size: 0.875rem;">A member of our team may reach out to discuss how Galoy can support your digital asset journey.</p>
      <a href="../index.html" class="btn btn-primary">
        Return to Homepage
        <span class="material-symbols-outlined">arrow_forward</span>
      </a>
    </div>
  </div>

  <script>
    // ===========================================
    // SURVEY WIZARD LOGIC
    // ===========================================

    const TOTAL_STEPS = 5;
    let currentStep = 1;
    const responses = {};

    // DOM Elements
    const steps = document.querySelectorAll('.survey-step');
    const progressFill = document.getElementById('progressFill');
    const stepIndicator = document.getElementById('stepIndicator');
    const percentComplete = document.getElementById('percentComplete');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const progressContainer = document.getElementById('progressContainer');
    const surveyNav = document.getElementById('surveyNav');
    const thankYouScreen = document.getElementById('thankYouScreen');

    // Initialize
    function init() {
      updateProgress();
      setupOptionCards();
      setupRanking();
      setupNavigation();
    }

    // Update progress bar
    function updateProgress() {
      const progress = ((currentStep - 1) / TOTAL_STEPS) * 100;
      progressFill.style.width = progress + '%';
      stepIndicator.textContent = `Question ${currentStep} of ${TOTAL_STEPS}`;
      percentComplete.textContent = Math.round(progress) + '% complete';

      // Update back button visibility
      prevBtn.style.visibility = currentStep === 1 ? 'hidden' : 'visible';

      // Update next button text
      if (currentStep === TOTAL_STEPS) {
        nextBtn.innerHTML = 'Submit <span class="material-symbols-outlined">send</span>';
      } else {
        nextBtn.innerHTML = 'Next <span class="material-symbols-outlined">arrow_forward</span>';
      }
    }

    // Show specific step
    function showStep(stepNumber) {
      steps.forEach(step => {
        step.classList.remove('active');
        if (parseInt(step.dataset.step) === stepNumber) {
          step.classList.add('active');
        }
      });
      currentStep = stepNumber;
      updateProgress();
    }

    // Setup option card click handlers
    function setupOptionCards() {
      document.querySelectorAll('.option-card').forEach(card => {
        card.addEventListener('click', function(e) {
          // Prevent default label behavior to avoid double-toggle
          e.preventDefault();

          const input = this.querySelector('input');
          const optionsList = this.closest('.options-list');
          const type = optionsList?.dataset.type;
          const maxSelections = parseInt(optionsList?.dataset.max) || Infinity;

          if (type === 'radio') {
            // Deselect all others in the group
            optionsList.querySelectorAll('.option-card').forEach(c => c.classList.remove('selected'));
            this.classList.add('selected');
            input.checked = true;
          } else if (type === 'checkbox') {
            const selectedCount = optionsList.querySelectorAll('.option-card.selected').length;
            const isCurrentlySelected = this.classList.contains('selected');

            if (isCurrentlySelected) {
              // Deselect this option
              this.classList.remove('selected');
              input.checked = false;
            } else if (selectedCount < maxSelections) {
              // Select this option (if under limit)
              this.classList.add('selected');
              input.checked = true;
            } else {
              // At max selections - show feedback
              this.style.animation = 'shake 0.3s ease';
              setTimeout(() => this.style.animation = '', 300);
            }
          }
        });
      });
    }

    // Setup ranking drag and drop (desktop) + button controls (mobile)
    function setupRanking() {
      const rankingList = document.getElementById('rankingList');
      if (!rankingList) return;

      let draggedItem = null;

      rankingList.querySelectorAll('.ranking-option').forEach(item => {
        // Desktop drag events
        item.addEventListener('dragstart', function() {
          draggedItem = this;
          setTimeout(() => this.classList.add('dragging'), 0);
        });

        item.addEventListener('dragend', function() {
          this.classList.remove('dragging');
          updateRankingNumbers();
          updateRankingButtons();
        });

        item.addEventListener('dragover', function(e) {
          e.preventDefault();
          const afterElement = getDragAfterElement(rankingList, e.clientY);
          if (afterElement == null) {
            rankingList.appendChild(draggedItem);
          } else {
            rankingList.insertBefore(draggedItem, afterElement);
          }
        });
      });

      // Mobile button controls
      rankingList.querySelectorAll('.ranking-up').forEach(btn => {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          const item = this.closest('.ranking-option');
          const prev = item.previousElementSibling;
          if (prev) {
            rankingList.insertBefore(item, prev);
            updateRankingNumbers();
            updateRankingButtons();
          }
        });
      });

      rankingList.querySelectorAll('.ranking-down').forEach(btn => {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          const item = this.closest('.ranking-option');
          const next = item.nextElementSibling;
          if (next) {
            rankingList.insertBefore(next, item);
            updateRankingNumbers();
            updateRankingButtons();
          }
        });
      });

      // Initial button state
      updateRankingButtons();
    }

    // Update disabled state of ranking buttons
    function updateRankingButtons() {
      const rankingList = document.getElementById('rankingList');
      if (!rankingList) return;

      const items = rankingList.querySelectorAll('.ranking-option');
      items.forEach((item, index) => {
        const upBtn = item.querySelector('.ranking-up');
        const downBtn = item.querySelector('.ranking-down');

        if (upBtn) upBtn.disabled = (index === 0);
        if (downBtn) downBtn.disabled = (index === items.length - 1);
      });
    }

    function getDragAfterElement(container, y) {
      const draggableElements = [...container.querySelectorAll('.ranking-option:not(.dragging)')];

      return draggableElements.reduce((closest, child) => {
        const box = child.getBoundingClientRect();
        const offset = y - box.top - box.height / 2;
        if (offset < 0 && offset > closest.offset) {
          return { offset: offset, element: child };
        } else {
          return closest;
        }
      }, { offset: Number.NEGATIVE_INFINITY }).element;
    }

    function updateRankingNumbers() {
      document.querySelectorAll('.ranking-option').forEach((item, index) => {
        item.querySelector('.ranking-number').textContent = index + 1;
      });
    }

    // Setup navigation
    function setupNavigation() {
      prevBtn.addEventListener('click', () => {
        if (currentStep > 1) {
          showStep(currentStep - 1);
        }
      });

      nextBtn.addEventListener('click', () => {
        if (validateCurrentStep()) {
          collectStepData();

          if (currentStep < TOTAL_STEPS) {
            showStep(currentStep + 1);
          } else {
            submitSurvey();
          }
        }
      });
    }

    // Validate current step
    function validateCurrentStep() {
      const activeStep = document.querySelector('.survey-step.active');

      // Step 1, 3, 4: Radio/Checkbox selection
      const optionsList = activeStep.querySelector('.options-list');
      if (optionsList) {
        const type = optionsList.dataset.type;
        if (type === 'radio') {
          const selected = activeStep.querySelector('input[type="radio"]:checked');
          if (!selected) {
            alert('Please select an option to continue.');
            return false;
          }
        }
        // Checkboxes are optional (can select 0)
      }

      // Step 5: Contact form
      if (currentStep === 5) {
        const firstName = document.getElementById('firstName').value.trim();
        const lastName = document.getElementById('lastName').value.trim();
        const email = document.getElementById('email').value.trim();

        if (!firstName || !lastName || !email) {
          alert('Please fill in all required fields.');
          return false;
        }

        if (!isValidEmail(email)) {
          alert('Please enter a valid email address.');
          return false;
        }
      }

      return true;
    }

    function isValidEmail(email) {
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
    }

    // Collect data from current step
    function collectStepData() {
      const activeStep = document.querySelector('.survey-step.active');

      // Radio selections
      const radioInputs = activeStep.querySelectorAll('input[type="radio"]:checked');
      radioInputs.forEach(input => {
        responses[input.name] = input.value;
      });

      // Checkbox selections
      const checkboxInputs = activeStep.querySelectorAll('input[type="checkbox"]:checked');
      if (checkboxInputs.length > 0) {
        const name = checkboxInputs[0].name;
        responses[name] = Array.from(checkboxInputs).map(input => input.value);
      }

      // Ranking
      if (currentStep === 2) {
        const rankings = [];
        document.querySelectorAll('.ranking-option').forEach(item => {
          rankings.push(item.dataset.value);
        });
        responses.ranking = rankings;
      }

      // Contact info
      if (currentStep === 5) {
        responses.firstName = document.getElementById('firstName').value.trim();
        responses.lastName = document.getElementById('lastName').value.trim();
        responses.email = document.getElementById('email').value.trim();
        responses.submittedAt = new Date().toISOString();
      }
    }

    // Submit survey
    async function submitSurvey() {
      nextBtn.disabled = true;
      nextBtn.innerHTML = 'Submitting... <span class="material-symbols-outlined">hourglass_empty</span>';

      try {
        // Send to Google Sheets via Apps Script Web App
        await sendToGoogleSheets(responses);

        // Show thank you screen
        progressContainer.style.display = 'none';
        surveyNav.style.display = 'none';
        document.querySelector('.survey-content').style.display = 'none';
        thankYouScreen.classList.add('active');

      } catch (error) {
        console.error('Submission error:', error);
        alert('There was an error submitting your response. Please try again.');
        nextBtn.disabled = false;
        nextBtn.innerHTML = 'Submit <span class="material-symbols-outlined">send</span>';
      }
    }

    // ===========================================
    // GOOGLE SHEETS INTEGRATION
    // ===========================================

    // Google Apps Script Web App URL
    const GOOGLE_SHEETS_URL = 'https://script.google.com/a/macros/galoy.io/s/AKfycbwj7N2_De77aI0MHLW4OmaX1FOBZlqaZmhbhquP2zYyIVDR3zvgTTI0-771bElrknCO/exec';

    async function sendToGoogleSheets(data) {
      // Format the data for the spreadsheet
      const payload = {
        timestamp: data.submittedAt,
        firstName: data.firstName,
        lastName: data.lastName,
        email: data.email,
        posture: data.posture || '',
        ranking: data.ranking ? data.ranking.join(', ') : '',
        capabilities: Array.isArray(data.capabilities) ? data.capabilities.join(', ') : '',
        leadership: data.leadership || ''
      };

      // If no Google Sheets URL configured, log to console
      if (GOOGLE_SHEETS_URL === 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL') {
        console.log('Survey Response (Google Sheets not configured):', payload);
        // Simulate delay
        await new Promise(resolve => setTimeout(resolve, 1000));
        return;
      }

      // Send to Google Sheets
      const response = await fetch(GOOGLE_SHEETS_URL, {
        method: 'POST',
        mode: 'no-cors',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(payload)
      });

      return response;
    }

    // Initialize on load
    init();
  </script>

</body>
</html>
