<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OCC Regulatory Radar | Galoy</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
    :root {
      --galoy-blue: #3654FF;
      --galoy-dark: #0a0a0a;
      --galoy-gray: #1a1a1a;
    }
    body { background: var(--galoy-dark); color: #fff; }
    .card { background: var(--galoy-gray); border: 1px solid #333; }
    .highlight { background: linear-gradient(135deg, rgba(54, 84, 255, 0.15), rgba(54, 84, 255, 0.05)); border-color: var(--galoy-blue); }

    /* Gradient text */
    .gradient-text {
      background: linear-gradient(135deg, #fff 0%, #3654FF 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: var(--galoy-dark); }
    ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: #444; }

    /* Tab styles */
    .tab { transition: all 0.2s ease; }
    .tab.active { background: var(--galoy-blue); color: white; }
    .tab:not(.active):hover { background: rgba(54, 84, 255, 0.1); }

    /* Table row hover */
    .table-row { transition: background 0.2s ease; }
    .table-row:hover { background: rgba(54, 84, 255, 0.1); }

    /* Bar animations */
    .bar { transition: all 0.4s ease; }

    /* Search input */
    .search-input:focus { outline: none; border-color: var(--galoy-blue); box-shadow: 0 0 0 3px rgba(54, 84, 255, 0.2); }

    /* Modal */
    .modal-overlay { backdrop-filter: blur(8px); }

    /* Stat card hover */
    .stat-card { transition: all 0.3s ease; }
    .stat-card:hover { transform: translateY(-2px); border-color: var(--galoy-blue); }

    /* Theme bar animation */
    .theme-bar { transition: width 0.5s ease; }
  </style>
</head>
<body class="min-h-screen">
  <!-- Header -->
  <header class="fixed top-0 left-0 right-0 z-50 bg-opacity-90 backdrop-blur-sm" style="background: rgba(10,10,10,0.9);">
    <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-8 h-8 rounded-lg flex items-center justify-center" style="background: var(--galoy-blue);">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5">
            <circle cx="12" cy="12" r="10"/>
            <path d="M12 6v6l4 2"/>
          </svg>
        </div>
        <span class="font-semibold text-white">Regulatory Radar</span>
      </div>
      <div class="flex items-center gap-4">
        <a href="bitcoin-backed-lending-101.html" class="text-sm text-gray-400 hover:text-white transition-colors">Lending 101 →</a>
        <a href="https://galoy.io" target="_blank" class="text-sm text-gray-400 hover:text-white transition-colors">galoy.io</a>
      </div>
    </div>
  </header>

  <main class="pt-24 pb-12 px-6">
    <div class="max-w-7xl mx-auto">
      <!-- Hero Section -->
      <div class="mb-10">
        <p class="text-sm font-medium mb-3" style="color: var(--galoy-blue);">OCC INTELLIGENCE DASHBOARD</p>
        <h1 class="text-3xl lg:text-4xl font-bold mb-4">
          OCC <span class="gradient-text">Regulatory Radar</span>
        </h1>
        <p class="text-gray-400 max-w-2xl mb-6">
          Track OCC guidance, interpretive letters, and regulatory developments enabling bitcoin in traditional banking. Stay ahead of the evolving regulatory landscape.
        </p>

        <!-- Tabs -->
        <div class="flex flex-wrap gap-2">
          <button class="tab active px-4 py-2 rounded-lg text-sm font-medium" data-tab="all">All Updates</button>
          <button class="tab px-4 py-2 rounded-lg text-sm font-medium text-gray-400" data-tab="high">High Priority</button>
          <button class="tab px-4 py-2 rounded-lg text-sm font-medium text-gray-400" data-tab="crypto">Crypto Focus</button>
        </div>
      </div>

      <!-- Stats Grid -->
      <div class="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
        <div class="card stat-card rounded-xl p-5">
          <p class="text-xs text-gray-400 mb-1">Total Items</p>
          <p id="statTotal" class="text-3xl font-bold">36</p>
          <p class="text-xs text-gray-500 mt-1">Regulatory updates tracked</p>
        </div>
        <div class="card stat-card rounded-xl p-5">
          <p class="text-xs text-gray-400 mb-1">High Priority</p>
          <p id="statHigh" class="text-3xl font-bold text-red-400">17</p>
          <p class="text-xs text-gray-500 mt-1">Requires attention</p>
        </div>
        <div class="card stat-card rounded-xl p-5">
          <p class="text-xs text-gray-400 mb-1">Crypto-Related</p>
          <p id="statCrypto" class="text-3xl font-bold" style="color: var(--galoy-blue);">13</p>
          <p class="text-xs text-gray-500 mt-1">Digital asset updates</p>
        </div>
        <div class="card stat-card rounded-xl p-5">
          <p class="text-xs text-gray-400 mb-1">Medium Priority</p>
          <p id="statMedium" class="text-3xl font-bold text-yellow-400">5</p>
          <p class="text-xs text-gray-500 mt-1">Monitor closely</p>
        </div>
      </div>

      <!-- Charts Row -->
      <div class="grid lg:grid-cols-3 gap-6 mb-8">
        <!-- Timeline Chart -->
        <div class="lg:col-span-2 card rounded-2xl p-6">
          <h3 class="text-sm font-semibold mb-6 flex items-center gap-2">
            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" style="color: var(--galoy-blue);"><path d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/></svg>
            Regulatory Activity Timeline
          </h3>
          <div class="h-48 flex items-end gap-2" id="timelineChart"></div>
          <div class="flex justify-between text-xs text-gray-500 mt-3 px-1" id="timelineLabels"></div>
          <div class="flex items-center justify-center gap-6 mt-4 text-xs">
            <div class="flex items-center gap-2"><div class="w-3 h-3 rounded bg-red-400"></div><span class="text-gray-400">High</span></div>
            <div class="flex items-center gap-2"><div class="w-3 h-3 rounded bg-yellow-400"></div><span class="text-gray-400">Medium</span></div>
            <div class="flex items-center gap-2"><div class="w-3 h-3 rounded bg-gray-500"></div><span class="text-gray-400">Low</span></div>
          </div>
        </div>

        <!-- Priority Distribution -->
        <div class="card rounded-2xl p-6">
          <h3 class="text-sm font-semibold mb-6 flex items-center gap-2">
            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" style="color: var(--galoy-blue);"><path d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"/><path d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"/></svg>
            Priority Distribution
          </h3>
          <div class="flex flex-col items-center">
            <div class="relative w-40 h-40 mb-6">
              <div id="pieChart" class="w-full h-full rounded-full"></div>
              <div class="absolute inset-0 flex items-center justify-center">
                <div class="w-20 h-20 rounded-full" style="background: var(--galoy-gray);"></div>
              </div>
            </div>
            <div class="flex flex-wrap justify-center gap-4 text-xs" id="pieLegend"></div>
          </div>
        </div>
      </div>

      <!-- Top Themes -->
      <div class="card rounded-2xl p-6 mb-8">
        <h3 class="text-sm font-semibold mb-6 flex items-center gap-2">
          <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" style="color: var(--galoy-blue);"><path d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/></svg>
          Top Regulatory Themes
        </h3>
        <div class="space-y-3" id="themeBars"></div>
      </div>

      <!-- Filters -->
      <div class="card rounded-2xl p-4 mb-6">
        <div class="flex flex-wrap gap-4 items-center">
          <div class="flex-1 min-w-[200px]">
            <input type="text" id="searchInput" placeholder="Search by title, ID, or theme..."
                   class="search-input w-full px-4 py-2.5 bg-black bg-opacity-40 border border-gray-700 rounded-lg text-sm text-white placeholder-gray-500">
          </div>
          <select id="priorityFilter" class="px-4 py-2.5 bg-black bg-opacity-40 border border-gray-700 rounded-lg text-sm text-white cursor-pointer">
            <option value="all">All Priorities</option>
            <option value="High">High Priority</option>
            <option value="Medium">Medium Priority</option>
            <option value="Low">Low Priority</option>
          </select>
          <select id="sourceFilter" class="px-4 py-2.5 bg-black bg-opacity-40 border border-gray-700 rounded-lg text-sm text-white cursor-pointer">
            <option value="all">All Sources</option>
            <option value="Interpretive Letter">Interpretive Letter</option>
            <option value="News Release">News Release</option>
            <option value="Bulletin">Bulletin</option>
          </select>
          <div class="px-4 py-2.5 bg-black bg-opacity-40 rounded-lg text-sm">
            <span id="filteredCount" class="font-bold" style="color: var(--galoy-blue);">36</span>
            <span class="text-gray-500"> of <span id="totalCount">36</span> items</span>
          </div>
        </div>
      </div>

      <!-- Data Table -->
      <div class="card rounded-2xl overflow-hidden">
        <div class="overflow-x-auto">
          <table class="w-full">
            <thead>
              <tr class="border-b border-gray-800">
                <th class="text-left py-4 px-6 text-xs font-semibold text-gray-500 uppercase tracking-wide">Date</th>
                <th class="text-left py-4 px-6 text-xs font-semibold text-gray-500 uppercase tracking-wide">ID</th>
                <th class="text-left py-4 px-6 text-xs font-semibold text-gray-500 uppercase tracking-wide">Title</th>
                <th class="text-left py-4 px-6 text-xs font-semibold text-gray-500 uppercase tracking-wide">Source</th>
                <th class="text-left py-4 px-6 text-xs font-semibold text-gray-500 uppercase tracking-wide">Priority</th>
                <th class="text-left py-4 px-6 text-xs font-semibold text-gray-500 uppercase tracking-wide">Themes</th>
              </tr>
            </thead>
            <tbody id="tableBody"></tbody>
          </table>
        </div>
      </div>

      <!-- Footer -->
      <footer class="mt-12 pt-8 border-t border-gray-800">
        <div class="flex flex-col md:flex-row justify-between items-center gap-4">
          <p class="text-sm text-gray-500">Data source: OCC Regulatory Radar • Last updated: January 2026</p>
          <p class="text-sm text-gray-500">Built by <a href="https://galoy.io" target="_blank" class="hover:text-white transition-colors">Galoy</a> — Bitcoin-native banking infrastructure</p>
        </div>
      </footer>
    </div>
  </main>

  <!-- Modal -->
  <div class="modal-overlay fixed inset-0 bg-black bg-opacity-80 hidden items-center justify-center z-50 p-4" id="modal">
    <div class="card rounded-2xl max-w-xl w-full max-h-[85vh] overflow-auto">
      <div class="p-6 border-b border-gray-800 flex justify-between items-start">
        <div>
          <p id="modalId" class="text-sm font-mono mb-1" style="color: var(--galoy-blue);"></p>
          <h2 id="modalTitle" class="text-xl font-bold"></h2>
        </div>
        <button onclick="closeModal()" class="text-gray-500 hover:text-white transition-colors p-1">
          <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M6 18L18 6M6 6l12 12"/></svg>
        </button>
      </div>
      <div class="p-6 space-y-5">
        <div id="modalBadges" class="flex flex-wrap gap-2"></div>
        <div>
          <p class="text-sm text-gray-400 mb-1">Date</p>
          <p id="modalDate" class="font-medium"></p>
        </div>
        <div>
          <p class="text-sm text-gray-400 mb-2">Themes</p>
          <div id="modalThemes" class="flex flex-wrap gap-2"></div>
        </div>
        <a href="#" id="modalLink" target="_blank" rel="noopener noreferrer"
           class="inline-flex items-center gap-2 px-5 py-2.5 rounded-lg font-medium transition-all hover:scale-105" style="background: var(--galoy-blue);">
          View Full Document
          <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/></svg>
        </a>
      </div>
    </div>
  </div>

  <script>
    // OCC Regulatory Data
    const rawData = [
      { date: "2025-03-07", source_type: "Interpretive Letter", id: "IL 1183", title: "Reaffirms permissibility of crypto custody, stablecoin reserves deposits, and DLT/stablecoins for permissible payments", url: "https://www.occ.gov/topics/charters-and-licensing/interpretations-and-actions/2025/int1183.pdf", theme_tags: "crypto; custody; stablecoins; payments", lead_signal: "High" },
      { date: "2025-03-07", source_type: "News Release", id: "NR 2025-16", title: "OCC Clarifies Bank Authority to Engage in Certain Cryptocurrency Activities", url: "https://www.occ.gov/news-issuances/news-releases/2025/nr-occ-2025-16.html", theme_tags: "crypto; permissibility", lead_signal: "High" },
      { date: "2025-03-17", source_type: "News Release", id: "NR 2025-19", title: "OCC Conditionally Approves Fintech Business Model for a National Bank", url: "https://www.occ.gov/news-issuances/news-releases/2025/nr-occ-2025-19.html", theme_tags: "chartering; fintech; de novo", lead_signal: "High" },
      { date: "2025-03-20", source_type: "News Release", id: "NR 2025-21", title: "OCC Ceases Examinations for Reputation Risk", url: "https://www.occ.gov/news-issuances/news-releases/2025/nr-occ-2025-21.html", theme_tags: "reputation risk; supervision", lead_signal: "High" },
      { date: "2025-04-08", source_type: "Bulletin", id: "OCC 2025-6", title: "CRA, Fair Housing Act, and ECOA: OCC Contact Information for Certain Notices and Posters", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-6.html", theme_tags: "CRA; consumer compliance", lead_signal: "Low" },
      { date: "2025-04-15", source_type: "Bulletin", id: "OCC 2025-7", title: "Real Estate Appraisals: Temporary Exceptions in Areas Affected by Los Angeles County Wildfires", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-7.html", theme_tags: "appraisals; disaster relief", lead_signal: "Low" },
      { date: "2025-05-05", source_type: "Bulletin", id: "OCC 2025-8", title: "Bank Activities: Request for Information on Community Bank Digitalization", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-8.html", theme_tags: "digitalization; community banks", lead_signal: "Medium" },
      { date: "2025-05-07", source_type: "News Release", id: "NR 2025-42", title: "OCC Clarifies Bank Authority to Engage in Crypto-Asset Custody and Execution Services", url: "https://www.occ.gov/news-issuances/news-releases/2025/nr-occ-2025-42.html", theme_tags: "crypto; custody; execution", lead_signal: "High" },
      { date: "2025-05-08", source_type: "Bulletin", id: "OCC 2025-9", title: "Business Combinations Under the Bank Merger Act: Rescission: Interim Final Rule", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-9.html", theme_tags: "M&A; bank merger act", lead_signal: "Low" },
      { date: "2025-05-12", source_type: "Bulletin", id: "OCC 2025-10", title: "Prohibition Against Interstate Deposits: Annual Host State Loan-to-Deposit Ratios", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-10.html", theme_tags: "interstate deposits; ratios", lead_signal: "Low" },
      { date: "2025-06-16", source_type: "Bulletin", id: "OCC 2025-12", title: "Payments Fraud: Request for Information on Potential Actions to Address Payments Fraud", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-12.html", theme_tags: "payments; fraud; risk", lead_signal: "Medium" },
      { date: "2025-06-23", source_type: "Bulletin", id: "OCC 2025-13", title: "Guidance on Referrals for Potential Criminal Enforcement: Notice", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-13.html", theme_tags: "enforcement; referrals", lead_signal: "Low" },
      { date: "2025-06-27", source_type: "Bulletin", id: "OCC 2025-14", title: "NPR: Modifications to the Enhanced Supplementary Leverage Ratio (eSLR) Standards", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-14.html", theme_tags: "capital; leverage; GSIB", lead_signal: "Low" },
      { date: "2025-06-27", source_type: "Bulletin", id: "OCC 2025-15", title: "BSA/AML: Customer Identification Program Tax Identification Number Alternative Collection Method", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-15.html", theme_tags: "BSA/AML; CIP", lead_signal: "Low" },
      { date: "2025-07-14", source_type: "Bulletin", id: "OCC 2025-16", title: "Fair Lending: Removing References to Disparate Impact", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-16.html", theme_tags: "fair lending; policy", lead_signal: "Low" },
      { date: "2025-07-14", source_type: "Bulletin", id: "OCC 2025-17", title: "Bank Activities: Crypto-Asset Safekeeping Services", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-17.html", theme_tags: "crypto; custody; safekeeping", lead_signal: "High" },
      { date: "2025-07-14", source_type: "News Release", id: "NR 2025-68", title: "Agencies Issue Joint Statement on Risk-Management Considerations For Crypto-Asset Safekeeping", url: "https://www.occ.gov/news-issuances/news-releases/2025/nr-ia-2025-68.html", theme_tags: "crypto; safekeeping; risk mgmt", lead_signal: "High" },
      { date: "2025-07-16", source_type: "Bulletin", id: "OCC 2025-18", title: "CRA: Interagency NPR to Rescind and Replace the 2023 CRA Final Rule", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-18.html", theme_tags: "CRA; rulemaking", lead_signal: "Low" },
      { date: "2025-07-25", source_type: "Bulletin", id: "OCC 2025-19", title: "EGRPRA: Regulatory Review to Identify Outdated, Unnecessary, or Unduly Burdensome Regulations", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-19.html", theme_tags: "reg burden; EGRPRA", lead_signal: "Low" },
      { date: "2025-08-15", source_type: "Bulletin", id: "OCC 2025-20", title: "Accounting: Bank Accounting Advisory Series Updated", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-20.html", theme_tags: "accounting", lead_signal: "Low" },
      { date: "2025-08-29", source_type: "Bulletin", id: "OCC 2025-21", title: "Fees and Assessments: Interim Calendar Year 2025 Fees and Assessments Structure", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-21.html", theme_tags: "fees", lead_signal: "Low" },
      { date: "2025-09-08", source_type: "Bulletin", id: "OCC 2025-22", title: "Licensing and CRA: Consideration of Politicized or Unlawful Debanking", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-22.html", theme_tags: "debanking; licensing; CRA", lead_signal: "High" },
      { date: "2025-09-08", source_type: "Bulletin", id: "OCC 2025-23", title: "Protecting Customer Financial Records", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-23.html", theme_tags: "privacy; records", lead_signal: "Low" },
      { date: "2025-10-06", source_type: "Bulletin", id: "OCC 2025-24", title: "Examinations: Frequency and Scope for Community Banks", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-24.html", theme_tags: "supervision; exams", lead_signal: "Low" },
      { date: "2025-10-06", source_type: "Bulletin", id: "OCC 2025-28", title: "NPR: Community Bank Licensing Amendments", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-28.html", theme_tags: "licensing; community banks", lead_signal: "Medium" },
      { date: "2025-10-07", source_type: "Bulletin", id: "OCC 2025-29", title: "Interagency NPR: Defining 'Unsafe or Unsound Practice' and Revising the MRA Framework", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-29.html", theme_tags: "supervision; MRAs", lead_signal: "Medium" },
      { date: "2025-10-07", source_type: "Bulletin", id: "OCC 2025-30", title: "NPR: Prohibition on Use of Reputation Risk by Regulators", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-30.html", theme_tags: "reputation risk; supervision", lead_signal: "High" },
      { date: "2025-10-15", source_type: "News Release", id: "NR 2025-101", title: "OCC Announces Conditional Approval for Chartering Erebor Bank", url: "https://www.occ.gov/news-issuances/news-releases/2025/nr-occ-2025-101.html", theme_tags: "chartering; de novo", lead_signal: "High" },
      { date: "2025-11-18", source_type: "Interpretive Letter", id: "IL 1186", title: "Banks may pay blockchain network fees and hold limited crypto as principal", url: "https://www.occ.gov/topics/charters-and-licensing/interpretations-and-actions/2025/int1186.pdf", theme_tags: "crypto; network fees; operations", lead_signal: "High" },
      { date: "2025-11-18", source_type: "News Release", id: "NR 2025-108", title: "OCC Confirms Bank Authority to Hold Crypto-Assets for Paying Network Fees", url: "https://www.occ.gov/news-issuances/news-releases/2025/nr-occ-2025-108.html", theme_tags: "crypto; network fees", lead_signal: "High" },
      { date: "2025-11-24", source_type: "Bulletin", id: "OCC 2025-39", title: "Bank Activities: RFI on Community Banks' Engagement with Core Service Providers", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-39.html", theme_tags: "third-party; core processors", lead_signal: "High" },
      { date: "2025-12-05", source_type: "Bulletin", id: "OCC 2025-45", title: "Commercial Lending: Venture Loans to Companies in Early/Expansion/Late Stage Development", url: "https://www.occ.gov/news-issuances/bulletins/2025/bulletin-2025-45.html", theme_tags: "venture debt; lending", lead_signal: "Medium" },
      { date: "2025-12-09", source_type: "Interpretive Letter", id: "IL 1188", title: "Banks may engage in riskless principal transactions in crypto-assets", url: "https://www.occ.gov/topics/charters-and-licensing/interpretations-and-actions/2025/int1188.pdf", theme_tags: "crypto; execution; riskless principal", lead_signal: "High" },
      { date: "2025-12-09", source_type: "News Release", id: "NR 2025-121", title: "OCC Confirms Bank Authority to Engage in Riskless Principal Crypto-Asset Transactions", url: "https://www.occ.gov/news-issuances/news-releases/2025/nr-occ-2025-121.html", theme_tags: "crypto; execution; riskless principal", lead_signal: "High" },
      { date: "2025-12-10", source_type: "News Release", id: "NR 2025-123", title: "OCC Releases Preliminary Findings from Its Review of Large Banks' Debanking Activities", url: "https://www.occ.gov/news-issuances/news-releases/2025/nr-occ-2025-123.html", theme_tags: "debanking; supervision", lead_signal: "High" },
      { date: "2025-12-12", source_type: "News Release", id: "NR 2025-125", title: "OCC Announces Conditional Approvals for Five National Trust Bank Charter Applications", url: "https://www.occ.gov/news-issuances/news-releases/2025/nr-occ-2025-125.html", theme_tags: "trust bank; charters", lead_signal: "High" }
    ];

    let activeTab = 'all';
    let currentData = [...rawData];

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      updateStats();
      renderTimeline();
      renderPieChart();
      renderThemeBars();
      renderTable();
      setupEventListeners();
    });

    function updateStats() {
      const high = rawData.filter(d => d.lead_signal === 'High').length;
      const medium = rawData.filter(d => d.lead_signal === 'Medium').length;
      const crypto = rawData.filter(d => d.theme_tags.toLowerCase().includes('crypto')).length;

      document.getElementById('statTotal').textContent = rawData.length;
      document.getElementById('statHigh').textContent = high;
      document.getElementById('statMedium').textContent = medium;
      document.getElementById('statCrypto').textContent = crypto;
      document.getElementById('totalCount').textContent = rawData.length;
    }

    function renderTimeline() {
      const months = {};
      const monthNames = ['Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

      rawData.forEach(item => {
        const month = item.date.substring(0, 7);
        if (!months[month]) months[month] = { High: 0, Medium: 0, Low: 0 };
        months[month][item.lead_signal]++;
      });

      const sortedMonths = Object.keys(months).sort();
      const maxTotal = Math.max(...sortedMonths.map(m => months[m].High + months[m].Medium + months[m].Low));

      const container = document.getElementById('timelineChart');
      const labelsContainer = document.getElementById('timelineLabels');
      container.innerHTML = '';
      labelsContainer.innerHTML = '';

      sortedMonths.forEach(month => {
        const data = months[month];
        const total = data.High + data.Medium + data.Low;

        const barGroup = document.createElement('div');
        barGroup.className = 'flex-1 flex flex-col items-center gap-1';

        // Stacked bars
        const stack = document.createElement('div');
        stack.className = 'w-full flex flex-col justify-end h-40 gap-0.5';

        if (data.High > 0) {
          const bar = document.createElement('div');
          bar.className = 'bar w-full rounded-t bg-red-400 cursor-pointer';
          bar.style.height = (data.High / maxTotal * 100) + '%';
          bar.title = 'High: ' + data.High;
          stack.appendChild(bar);
        }
        if (data.Medium > 0) {
          const bar = document.createElement('div');
          bar.className = 'bar w-full bg-yellow-400 cursor-pointer';
          bar.style.height = (data.Medium / maxTotal * 100) + '%';
          bar.title = 'Medium: ' + data.Medium;
          stack.appendChild(bar);
        }
        if (data.Low > 0) {
          const bar = document.createElement('div');
          bar.className = 'bar w-full rounded-b bg-gray-500 cursor-pointer';
          bar.style.height = (data.Low / maxTotal * 100) + '%';
          bar.title = 'Low: ' + data.Low;
          stack.appendChild(bar);
        }

        barGroup.appendChild(stack);
        container.appendChild(barGroup);

        // Label
        const label = document.createElement('span');
        label.textContent = monthNames[parseInt(month.split('-')[1]) - 3] || month.split('-')[1];
        labelsContainer.appendChild(label);
      });
    }

    function renderPieChart() {
      const high = rawData.filter(d => d.lead_signal === 'High').length;
      const medium = rawData.filter(d => d.lead_signal === 'Medium').length;
      const low = rawData.filter(d => d.lead_signal === 'Low').length;
      const total = high + medium + low;

      const highPct = (high / total) * 100;
      const mediumPct = (medium / total) * 100;

      const pie = document.getElementById('pieChart');
      pie.style.background = `conic-gradient(
        #f87171 0% ${highPct}%,
        #facc15 ${highPct}% ${highPct + mediumPct}%,
        #6b7280 ${highPct + mediumPct}% 100%
      )`;

      document.getElementById('pieLegend').innerHTML = `
        <div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-red-400"></div><span class="text-gray-400">High (${high})</span></div>
        <div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-yellow-400"></div><span class="text-gray-400">Medium (${medium})</span></div>
        <div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-gray-500"></div><span class="text-gray-400">Low (${low})</span></div>
      `;
    }

    function renderThemeBars() {
      const themes = {};
      rawData.forEach(item => {
        item.theme_tags.split(';').forEach(tag => {
          const t = tag.trim();
          if (t) themes[t] = (themes[t] || 0) + 1;
        });
      });

      const sorted = Object.entries(themes).sort((a, b) => b[1] - a[1]).slice(0, 8);
      const maxCount = sorted[0][1];

      const container = document.getElementById('themeBars');
      container.innerHTML = '';

      sorted.forEach(([name, count]) => {
        const item = document.createElement('div');
        item.className = 'flex items-center gap-4';
        item.innerHTML = `
          <div class="w-28 text-right text-sm text-gray-400 truncate">${name}</div>
          <div class="flex-1 h-6 bg-gray-800 rounded-lg overflow-hidden">
            <div class="theme-bar h-full rounded-lg" style="width: ${(count / maxCount) * 100}%; background: linear-gradient(90deg, #3654FF, #5b7aff);"></div>
          </div>
          <div class="w-8 text-sm text-gray-500">${count}</div>
        `;
        container.appendChild(item);
      });
    }

    function renderTable() {
      const tbody = document.getElementById('tableBody');
      tbody.innerHTML = '';

      currentData.forEach(item => {
        const tr = document.createElement('tr');
        tr.className = 'table-row border-b border-gray-800 cursor-pointer';
        tr.onclick = () => openModal(item);

        const date = new Date(item.date);
        const dateStr = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });

        // Source badge colors
        let sourceClasses = 'px-2 py-0.5 rounded text-xs font-medium ';
        if (item.source_type === 'Interpretive Letter') {
          sourceClasses += 'bg-blue-500 bg-opacity-20 text-blue-400';
        } else if (item.source_type === 'News Release') {
          sourceClasses += 'bg-green-500 bg-opacity-20 text-green-400';
        } else {
          sourceClasses += 'bg-yellow-500 bg-opacity-20 text-yellow-400';
        }

        // Priority badge colors
        let priorityClasses = 'inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ';
        let dotColor = '';
        if (item.lead_signal === 'High') {
          priorityClasses += 'bg-red-500 bg-opacity-15 text-red-400';
          dotColor = 'bg-red-400';
        } else if (item.lead_signal === 'Medium') {
          priorityClasses += 'bg-yellow-500 bg-opacity-15 text-yellow-400';
          dotColor = 'bg-yellow-400';
        } else {
          priorityClasses += 'bg-gray-500 bg-opacity-15 text-gray-400';
          dotColor = 'bg-gray-400';
        }

        const tags = item.theme_tags.split(';').slice(0, 2).map(t =>
          `<span class="px-2 py-0.5 bg-gray-800 rounded text-xs text-gray-400">${t.trim()}</span>`
        ).join('');

        tr.innerHTML = `
          <td class="py-4 px-6 text-sm text-gray-400 whitespace-nowrap">${dateStr}</td>
          <td class="py-4 px-6 text-sm font-mono font-medium whitespace-nowrap">${item.id}</td>
          <td class="py-4 px-6 text-sm max-w-md"><div class="line-clamp-2">${item.title}</div></td>
          <td class="py-4 px-6 whitespace-nowrap"><span class="${sourceClasses}">${item.source_type}</span></td>
          <td class="py-4 px-6 whitespace-nowrap"><span class="${priorityClasses}"><span class="w-1.5 h-1.5 rounded-full ${dotColor}"></span>${item.lead_signal}</span></td>
          <td class="py-4 px-6"><div class="flex flex-wrap gap-1">${tags}</div></td>
        `;
        tbody.appendChild(tr);
      });

      document.getElementById('filteredCount').textContent = currentData.length;
    }

    function filterData() {
      const search = document.getElementById('searchInput').value.toLowerCase();
      const priority = document.getElementById('priorityFilter').value;
      const source = document.getElementById('sourceFilter').value;

      currentData = rawData.filter(item => {
        const matchesSearch = search === '' ||
          item.title.toLowerCase().includes(search) ||
          item.theme_tags.toLowerCase().includes(search) ||
          item.id.toLowerCase().includes(search);

        const matchesPriority = priority === 'all' || item.lead_signal === priority;
        const matchesSource = source === 'all' || item.source_type === source;

        const matchesTab = activeTab === 'all' ||
          (activeTab === 'crypto' && item.theme_tags.toLowerCase().includes('crypto')) ||
          (activeTab === 'high' && item.lead_signal === 'High');

        return matchesSearch && matchesPriority && matchesSource && matchesTab;
      });

      renderTable();
    }

    function setupEventListeners() {
      document.getElementById('searchInput').addEventListener('input', filterData);
      document.getElementById('priorityFilter').addEventListener('change', filterData);
      document.getElementById('sourceFilter').addEventListener('change', filterData);

      document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', function() {
          document.querySelectorAll('.tab').forEach(t => {
            t.classList.remove('active');
            t.classList.add('text-gray-400');
          });
          this.classList.add('active');
          this.classList.remove('text-gray-400');
          activeTab = this.dataset.tab;
          filterData();
        });
      });

      document.getElementById('modal').addEventListener('click', function(e) {
        if (e.target === this) closeModal();
      });
    }

    function openModal(item) {
      document.getElementById('modalId').textContent = item.id;
      document.getElementById('modalTitle').textContent = item.title;

      const date = new Date(item.date);
      document.getElementById('modalDate').textContent = date.toLocaleDateString('en-US', {
        weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'
      });

      // Badges
      let priorityClasses = 'inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ';
      let dotColor = '';
      if (item.lead_signal === 'High') {
        priorityClasses += 'bg-red-500 bg-opacity-15 text-red-400';
        dotColor = 'bg-red-400';
      } else if (item.lead_signal === 'Medium') {
        priorityClasses += 'bg-yellow-500 bg-opacity-15 text-yellow-400';
        dotColor = 'bg-yellow-400';
      } else {
        priorityClasses += 'bg-gray-500 bg-opacity-15 text-gray-400';
        dotColor = 'bg-gray-400';
      }

      let sourceClasses = 'px-2 py-0.5 rounded text-xs font-medium ';
      if (item.source_type === 'Interpretive Letter') {
        sourceClasses += 'bg-blue-500 bg-opacity-20 text-blue-400';
      } else if (item.source_type === 'News Release') {
        sourceClasses += 'bg-green-500 bg-opacity-20 text-green-400';
      } else {
        sourceClasses += 'bg-yellow-500 bg-opacity-20 text-yellow-400';
      }

      document.getElementById('modalBadges').innerHTML = `
        <span class="${priorityClasses}"><span class="w-1.5 h-1.5 rounded-full ${dotColor}"></span>${item.lead_signal}</span>
        <span class="${sourceClasses}">${item.source_type}</span>
      `;

      document.getElementById('modalThemes').innerHTML = item.theme_tags.split(';')
        .map(t => `<span class="px-3 py-1.5 rounded-full text-sm font-medium" style="background: rgba(54, 84, 255, 0.2); color: #6b8aff;">${t.trim()}</span>`)
        .join('');

      document.getElementById('modalLink').href = item.url;
      document.getElementById('modal').classList.remove('hidden');
      document.getElementById('modal').classList.add('flex');
    }

    function closeModal() {
      document.getElementById('modal').classList.add('hidden');
      document.getElementById('modal').classList.remove('flex');
    }
  </script>
</body>
</html>
